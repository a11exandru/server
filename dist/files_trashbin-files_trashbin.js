/*! For license information please see files_trashbin-files_trashbin.js.LICENSE.txt */ !function(){var e,c,b,f,g={6564:function(){OCA.Trashbin={},OCA.Trashbin.App={_initialized:!1,client:null,initialize:function(b){if(!this._initialized){this._initialized=!0,this.client=new OC.Files.Client({host:OC.getHost(),port:OC.getPort(),root:OC.linkToRemoteBase("dav")+"/trashbin/"+OC.getCurrentUser().uid,useHTTPS:"https"===OC.getProtocol()});var a=OC.Util.History.parseUrlQuery();this.fileList=new OCA.Trashbin.FileList($("#app-content-trashbin"),{fileActions:this._createFileActions(),detailsViewEnabled:!1,scrollTo:a.scrollto,config:OCA.Files.App.getFilesConfig(),multiSelectMenu:[{name:"restore",displayName:t("files_trashbin","Restore"),iconClass:"icon-history"},{name:"delete",displayName:t("files_trashbin","Delete permanently"),iconClass:"icon-delete"}],client:this.client,shown:!0})}},_createFileActions:function(){var b=this.client,a=new OCA.Files.FileActions;return a.register("dir","Open",OC.PERMISSION_READ,"",function(b,a){var c=a.fileList.getCurrentDirectory();a.fileList.changeDirectory(OC.joinPaths(c,b))}),a.setDefault("dir","Open"),a.registerAction({name:"Restore",displayName:t("files_trashbin","Restore"),type:OCA.Files.FileActions.TYPE_INLINE,mime:"all",permissions:OC.PERMISSION_READ,iconClass:"icon-history",actionHandler:function(a,d){var c=d.fileList,e=c.findFileEl(a);c.showFileBusyState(e,!0);var f=d.fileList.getCurrentDirectory();b.move(OC.joinPaths("trash",f,a),OC.joinPaths("restore",a),!0).then(c._removeCallback.bind(c,[a]),function(){c.showFileBusyState(e,!1),OC.Notification.show(t("files_trashbin","Error while restoring file from trash bin"))})}}),a.registerAction({name:"Delete",displayName:t("files_trashbin","Delete permanently"),mime:"all",permissions:OC.PERMISSION_READ,iconClass:"icon-delete",render:function(d,e,c){var b=a._makeActionLink(d,c);return b.attr("original-title",t("files_trashbin","Delete permanently")),b.children("img").attr("alt",t("files_trashbin","Delete permanently")),c.$file.find("td:last").append(b),b},actionHandler:function(c,d){var a=d.fileList;$(".tipsy").remove();var e=a.findFileEl(c);a.showFileBusyState(e,!0);var f=d.fileList.getCurrentDirectory();b.remove(OC.joinPaths("trash",f,c)).then(a._removeCallback.bind(a,[c]),function(){a.showFileBusyState(e,!1),OC.Notification.show(t("files_trashbin","Error while removing file from trash bin"))})}}),a}},window.addEventListener("DOMContentLoaded",function(){$("#app-content-trashbin").one("show",function(){OCA.Trashbin.App.initialize($("#app-content-trashbin"))})})},92832:function(){!function(){var b=new RegExp(/^(.+)\.d[0-9]+$/),c="{http://nextcloud.org/ns}trashbin-filename",d="{http://nextcloud.org/ns}trashbin-deletion-time",e="{http://nextcloud.org/ns}trashbin-original-location",f="{http://nextcloud.org/ns}trashbin-title";function g(a){a=OC.basename(a);var c=b.exec(a);return c&&c.length>1&&(a=c[1]),a}isFakeDir="{http://nextcloud.org/ns}trashbin-fake-directory";var a=function(b,a){this.client=a.client,this.initialize(b,a)};a.prototype=_.extend({},OCA.Files.FileList.prototype,{id:"trashbin",appName:t("files_trashbin","Deleted files"),client:null,initialize:function(){this.client.addFileInfoParser(function(b,j){var a=b.propStat[0].properties,g=a[e],h=a[isFakeDir],i=a[f];return{displayName:a[c],mtime:1e3*parseInt(a[d],10),hasPreview:!0,path:g,extraData:i,fakeDir:h}});var a=OCA.Files.FileList.prototype.initialize.apply(this,arguments);return this.$el.find(".undelete").click("click",_.bind(this._onClickRestoreSelected,this)),this.setSort("mtime","desc"),this.breadcrumb._makeCrumbs=function(){for(var a=OCA.Files.BreadCrumb.prototype._makeCrumbs.apply(this,[].concat(Array.prototype.slice.call(arguments),["icon-delete no-hover"])),b=1;b<a.length;b++)a[b].name=g(a[b].name);return a},OC.Plugins.attach("OCA.Trashbin.FileList",this),a},_removeActionsForFakeFolders:function(){$('tr[data-fakedir="true"]').each(function(){$(this).find(".filename span.fileactions").remove()})},getDirectoryPermissions:function(){return OC.PERMISSION_READ|OC.PERMISSION_DELETE},_setCurrentDir:function(b){OCA.Files.FileList.prototype._setCurrentDir.apply(this,arguments);var a=OC.basename(b);""!==a&&this.setPageTitle(g(a))},_createRow:function(){var a=OCA.Files.FileList.prototype._createRow.apply(this,arguments);return a.find("td.filesize").remove(),a},getAjaxUrl:function(c,a){var b="";return a&&(b="?"+OC.buildQueryString(a)),OC.filePath("files_trashbin","ajax",c+".php")+b},setupUploadEvents:function(){},linkTo:function(a){return OC.linkTo("files","index.php")+"?view=trashbin&dir="+encodeURIComponent(a).replace(/%2F/g,"/")},elementToFile:function(b){var a=OCA.Files.FileList.prototype.elementToFile(b);return"/"===this.getCurrentDirectory()&&(a.displayName=g(a.name)),delete a.size,a},updateEmptyContent:function(){var a=this.$fileList.find("tr:first").exists();this.$el.find("#emptycontent").toggleClass("hidden",a),this.$el.find("#filestable th").toggleClass("hidden",!a)},_removeCallback:function(c){for(var a,b=0;b<c.length;b++)a=this.remove(OC.basename(c[b]),{updateSummary:!1}),this.fileSummary.remove({type:a.attr("data-type"),size:a.attr("data-size")});this.fileSummary.update(),this.updateEmptyContent()},_onClickRestoreSelected:function(c){c.preventDefault();for(var f=this,a=_.pluck(this.getSelectedFiles(),"name"),b=0;b<a.length;b++){var d=this.findFileEl(a[b]);this.showFileBusyState(d,!0)}this.fileMultiSelectMenu.toggleLoading("restore",!0);var e=a.map(function(a){return f.client.move(OC.joinPaths("trash",f.getCurrentDirectory(),a),OC.joinPaths("restore",a),!0).then(function(){f._removeCallback([a])})});return Promise.all(e).then(function(){f.fileMultiSelectMenu.toggleLoading("restore",!1)},function(){OC.Notification.show(t("files_trashbin","Error while restoring files from trash bin"))})},_onClickDeleteSelected:function(c){c.preventDefault();for(var g=this,d=this.$el.find(".select-all").is(":checked"),a=_.pluck(this.getSelectedFiles(),"name"),b=0;b<a.length;b++){var e=this.findFileEl(a[b]);this.showFileBusyState(e,!0)}if(d)return this.client.remove(OC.joinPaths("trash",this.getCurrentDirectory())).then(function(){g.hideMask(),g.setFiles([])},function(){OC.Notification.show(t("files_trashbin","Error while emptying trash bin"))});this.fileMultiSelectMenu.toggleLoading("delete",!0);var f=a.map(function(a){return g.client.remove(OC.joinPaths("trash",g.getCurrentDirectory(),a)).then(function(){g._removeCallback([a])})});return Promise.all(f).then(function(){g.fileMultiSelectMenu.toggleLoading("delete",!1)},function(){OC.Notification.show(t("files_trashbin","Error while removing files from trash bin"))})},_onClickFile:function(a){return"httpd/unix-directory"!==$(this).parent().parent().data("mime")&&a.preventDefault(),OCA.Files.FileList.prototype._onClickFile.apply(this,arguments)},generatePreviewUrl:function(a){return OC.generateUrl("/apps/files_trashbin/preview?")+$.param(a)},getDownloadUrl:function(){return"#"},getDefaultActionUrl:function(){return"#"},updateStorageStatistics:function(){},isSelectedDeletable:function(){return!0},_getWebdavProperties:function(){return[c,d,e,f,isFakeDir].concat(this.filesClient.getPropfindProperties())},reload:function(){this._selectedFiles={},this._selectionSummary.clear(),this.$el.find(".select-all").prop("checked",!1),this.showMask(),this._reloadCall&&this._reloadCall.abort(),this._reloadCall=this.client.getFolderContents("trash/"+this.getCurrentDirectory(),{includeParent:!1,properties:this._getWebdavProperties()});var a=this.reloadCallback.bind(this);return this._reloadCall.then(a,a)},reloadCallback:function(a,b){return delete this._reloadCall,this.hideMask(),!(401===a||(403===a?(this.changeDirectory("/"),OC.Notification.show(t("files","This operation is forbidden")),1):500===a?(this.changeDirectory("/"),OC.Notification.show(t("files","This directory is unavailable, please check the logs or contact the administrator")),1):404===a?(this.changeDirectory("/"),1):(0===a||this.setFiles(b),this._removeActionsForFakeFolders())))}}),OCA.Trashbin.FileList=a}()},69845:function(p,q,a){"use strict";a(6564),a(92832);var d=a(93379),e=a.n(d),f=a(7795),g=a.n(f),h=a(90569),i=a.n(h),j=a(3565),k=a.n(j),l=a(19216),m=a.n(l),n=a(44589),o=a.n(n),c=a(81412),b={};b.styleTagTransform=o(),b.setAttributes=k(),b.insert=i().bind(null,"head"),b.domAPI=g(),b.insertStyleElement=m(),e()(c.Z,b),c.Z&&c.Z.locals&&c.Z.locals,window.OCA.Trashbin=OCA.Trashbin},81412:function(c,d,a){"use strict";var e=a(87537),f=a.n(e),g=a(23645),b=a.n(g)()(f());b.push([c.id,"#app-content-trashbin tbody tr[data-type=file] td a.name,#app-content-trashbin tbody tr[data-type=file] td a.name span.nametext,#app-content-trashbin tbody tr[data-type=file] td a.name span.nametext span{cursor:default}#app-content-trashbin .summary :last-child{padding:0}#app-content-trashbin #filestable .summary .filesize{display:none}","",{version:3,sources:["webpack://./apps/files_trashbin/src/trash.scss"],names:[],mappings:"AASA,4MAGC,cAAA,CAGD,2CACC,SAAA,CAED,qDACC,YAAA",sourcesContent:['/*\n * Copyright (c) 2014\n *\n * This file is licensed under the Affero General Public License version 3\n * or later.\n *\n * See the COPYING-README file.\n *\n */\n#app-content-trashbin tbody tr[data-type="file"] td a.name,\n#app-content-trashbin tbody tr[data-type="file"] td a.name span.nametext,\n#app-content-trashbin tbody tr[data-type="file"] td a.name span.nametext span {\n	cursor: default;\n}\n\n#app-content-trashbin .summary :last-child {\n	padding: 0;\n}\n#app-content-trashbin #filestable .summary .filesize {\n	display: none;\n}\n\n'],sourceRoot:""}]),d.Z=b}},h={};function a(c){var d=h[c];if(void 0!==d)return d.exports;var b=h[c]={id:c,loaded:!1,exports:{}};return g[c].call(b.exports,b,b.exports,a),b.loaded=!0,b.exports}a.m=g,a.amdD=function(){throw new Error("define cannot be used indirect")},a.amdO={},f=[],a.O=function(i,d,e,b){if(!d){var g=1/0;for(c=0;c<f.length;c++){d=f[c][0],e=f[c][1],b=f[c][2];for(var j=!0,h=0;h<d.length;h++)g>=b&&Object.keys(a.O).every(function(b){return a.O[b](d[h])})?d.splice(h--,1):(j=!1,b<g&&(g=b));if(j){f.splice(c--,1);var k=e();void 0!==k&&(i=k)}}return i}b=b||0;for(var c=f.length;c>0&&f[c-1][2]>b;c--)f[c]=f[c-1];f[c]=[d,e,b]},a.n=function(c){var b=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(b,{a:b}),b},a.d=function(d,c){for(var b in c)a.o(c,b)&&!a.o(d,b)&&Object.defineProperty(d,b,{enumerable:!0,get:c[b]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(a){if("object"==typeof window)return window}}(),a.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},a.nmd=function(a){return a.paths=[],a.children||(a.children=[]),a},a.j=2325,a.b=document.baseURI||self.location.href,e={2325:0},a.O.j=function(a){return 0===e[a]},c=function(i,c){var d,b,f=c[0],g=c[1],j=c[2],h=0;if(f.some(function(a){return 0!==e[a]})){for(d in g)a.o(g,d)&&(a.m[d]=g[d]);if(j)var k=j(a)}for(i&&i(c);h<f.length;h++)b=f[h],a.o(e,b)&&e[b]&&e[b][0](),e[b]=0;return a.O(k)},(b=self.webpackChunknextcloud=self.webpackChunknextcloud||[]).forEach(c.bind(null,0)),b.push=c.bind(null,b.push.bind(b));var d=a.O(void 0,[7874],function(){return a(69845)});d=a.O(d)}()